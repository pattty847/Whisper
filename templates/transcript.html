{% extends "base.html" %}

{% block title %}Transcript{% endblock %}

{% block content %}
<button onclick="window.location.href='/'" class="btn btn-danger">⬅️ Back to Home</button>

<h1>Transcript</h1>

<!-- Video Metadata -->
<h2>Video Info:</h2>
{% if thumbnail %}
    <img src="{{ thumbnail }}" alt="Video Thumbnail" width="200">
{% endif %}
<p><strong>Title:</strong> {{ title }}</p>
<p><strong>Uploader:</strong> {{ uploader }}</p>

<pre id="transcript-text">{{ transcript_text }}</pre>

<a href="{{ url_for('download_transcript', filename=filename) }}" target="_blank" download>
    <button class="download">Download Transcript</button>
</a>
<button class="copy" onclick="copyToClipboard()">Copy to Clipboard</button>
{% endblock %}

{% block extra_head %}
<script>
    function copyToClipboard() {
        const text = document.getElementById('transcript-text').innerText;
        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(text).then(() => {
                alert('Transcript copied to clipboard!');
            }).catch(err => {
                console.error('Clipboard write failed', err);
                fallbackCopyText(text);
            });
        } else {
            fallbackCopyText(text);
        }
    }
    
    function fallbackCopyText(text) {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        try {
            document.execCommand('copy');
            alert('Transcript copied to clipboard (fallback)!');
        } catch (err) {
            alert('Failed to copy transcript.');
        }
        document.body.removeChild(textarea);
    }
    
</script>
{% endblock %}
