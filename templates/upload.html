{% extends "base.html" %}

{% block title %}Video to Text Transcription{% endblock %}

{% block content %}
<div style="text-align: center; margin-bottom: 20px;">
    <a href="/history" class="btn btn-primary">üìú View History</a>
</div>

<form method="post" enctype="multipart/form-data" onsubmit="showProgress()">
    <input type="file" name="file" accept="video/*">
    <p>OR</p>
    <input type="text" name="url" placeholder="Enter video URL (YouTube, Instagram, TikTok)">
    <input type="submit" value="Submit">
</form>

<p id="loading">Processing, please wait... ‚è≥</p>
<div id="progress-container">
    <div id="progress-bar">0%</div>
</div>
{% endblock %}

{% block extra_head %}
<script>
    function showProgress() {
        document.getElementById("loading").style.display = "block";
        document.getElementById("progress-container").style.display = "block";
        updateProgress();
    }

    function updateProgress() {
        fetch('/progress')
            .then(response => response.json())
            .then(data => {
                let progressBar = document.getElementById("progress-bar");
                progressBar.style.width = data.progress + "%";
                progressBar.innerText = data.progress + "%";

                if (data.progress < 100) {
                    setTimeout(updateProgress, 1000);
                } else {
                    document.getElementById("loading").innerText = "‚úÖ Done!";
                }
            });
    }
</script>
{% endblock %}